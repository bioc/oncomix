---
title: "OncoMix Vignette"
author: "Daniel PiquÃ©"
date: "`r Sys.Date()`"
output:
  html_document:
    toc: true
    toc_float: true
vignette: >
  %\VignetteIndexEntry{OncoMix Vignette}
  %\VignetteEngine{knitr::rmarkdown}
  \usepackage[utf8]{inputenc}
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = F)
```
 
## Introduction

OncoMix is an R package for identifying oncogene candidates based off of 2-component Gaussian mixture models. It estimates parameters using the expectation maximization procedure as implemented in the R package mclust. This tutorial will demonstrate how to identify oncogene candidates from a set of mRNA sequencing data.



The advent of large, well-curated databases, such as the [genomic data commons](https://gdc.cancer.gov/), that contain RNA sequencing data from hundreds of patient tumors has made it possible to identify oncogene candidates based off of mRNA expression alone. The method proposed here is the first developed to identify oncogenes from RNA-sequencing data in large cohorts of patients.

```{r}
#devtools::install_github("dpique/oncomix")
#setwd("\\\\data.einstein.yu.edu/home/dpique/dpLabNotebook/bimodality_brca_tcga/oncomix")
#library(devtools)
#install_github("dpique/oncomix")
#install.packages("oncomix")
#vignette("oncomix_vignette")

#remove.packages("oncomix")
library(oncomix)
```

### What do we expect an oncogene to look like?

```{r}
library(ggplot2)
oncomix::oncoMixIdeal()

```

The teal curves represent the probability distribution (PD) over expression values from a single gene obtained from multiple tumors samples. The red-orange curves represent the PD over expression values from the same gene obtained from multiple adjacent normal tissue samples. Visually, we see that for a theoretical oncogene, there is a *subgroup* of tumors that overexpresses this gene relative to normal tissue.

## Identify Oncogene Candidates 


```{r}
data(dfNmlIsof, dfTumorIsof, package="oncomix")

dim(dfNmlIsof)
dfNmlIsof[1:5, 1:5] #take a look at the matrix of mRNA expression data from adjacent normal samples

dim(dfTumorIsof)
dfTumorIsof[1:5, 1:5] #take a look at the matrix of mRNA expression data from tumors

mmParams = oncomix::mixModelParams(dfNmlIsof[,1:500], dfTumorIsof[,1:500]) #fits the mixture models, will take a few mins
head(mmParams)
```


## Visualize the output

```{r, fig.width = 7, fig.height= 6.5}
scatterMixPlot(mmParams)
```



- Now, highlight the isoforms with a selectivity index greater than .99

```{r, fig.width = 7, fig.height= 6.5}
scatterMixPlot(mmParams, selIndThresh = .99)
```


-  Show the distribution of the selectivity index across all isoforms
```{r}
library(ggplot2)
qplot(mmParams[,"SI"]) + geom_rug(alpha = 0.1) + theme_classic() + xlab("Selectivity Index")

```


- Create a histogram of an individual gene with the curves superimposed


### Create a clickable app that shows the identity of each isoform (and also its distribution in a pop-out menu). Create an option to show known oncogenic isoforms.
```{r}
library(shiny)
#runExample("01_hello")
#runExample("02_text")
#runExample("03_reactivity")
```

